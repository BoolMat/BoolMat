\documentclass[11pt]{article}

\usepackage{amsmath, amsfonts, amsthm, amssymb, latexsym, mathrsfs, pifont,
tabu, enumitem}
\usepackage[cm]{fullpage}
\usepackage{theoremref}
\usepackage[ruled, linesnumbered]{algorithm2e}

\newtheorem{thm}{Theorem}[section]
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{lemma}[thm]{Lemma}
\newtheorem*{defi}{Definition}
\newtheorem{ex}[thm]{Example}
\newtheorem{algo}[thm]{Algorithm}
\newenvironment{de}{\begin{defi}\rm}{\end{defi}}
\newenvironment{alg}{\begin{algo}\rm}{\end{algo}}
\newcommand{\proofref}[1]{\noindent {\emph{Proof of Theorem}~\ref{#1}.\ }}
\newcommand{\defn}[1]{\textbf{\textit{#1}}}
\numberwithin{equation}{section}

% Lists
%\def\labelenumi{\theenumi}
%\def\theenumi{(\roman{enumi})}

% Macros
\newcommand{\id}{\mbox{\rm id}}
\newcommand{\set}[2]{\ensuremath{\{#1 : #2 \}}}
\newcommand{\genset}[1]{\ensuremath{\langle\: #1 \:\rangle}}
\renewcommand{\to}{\longrightarrow}


% For Algorithms
\SetKwProg{Fn}{Function}{}{}
\SetKwFunction{FZeroIfNotSubset}{ZeroIfNotSubset}
\SetKwFunction{FRemoveDuplicateRows}{RemoveDuplicateRows}
\SetKwComment{Comment}{}{}
\SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
\DontPrintSemicolon

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\B}{\mathbb{B}}
\newcommand{\Bn}{M_n(\B)}
\newcommand{\Bm}[1]{M_{#1}(\B)}
\newcommand{\Refn}{M_n^{\text{id}}(\B)}
\newcommand{\Ref}[1]{M_{#1}^{\text{id}}(\B)}
\newcommand{\Halln}{M_n^{\text{S}}(\B)}
\newcommand{\Hall}[1]{M_{#1}^{\text{S}}(\B)}
\newcommand{\MTn}{M_n^{\text{T}}(\B)}
\newcommand{\MT}[1]{M_{#1}^{\text{T}}(\B)}
\newcommand{\UTn}{UT_n(\B)}
\newcommand{\LTn}{LT_n(\B)}
\renewcommand{\L}{\mathscr{L}}
\newcommand{\R}{\mathscr{R}}
\newcommand{\D}{\mathscr{D}}
\newcommand{\J}{\mathscr{J}}
\renewcommand{\H}{\mathscr{H}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\rank}{\operatorname{rank}}

\newcommand{\BGSet}{B_{n,n}}

\newcommand{\cmark}{\ding{51}}
\newcommand{\xmark}{\ding{55}}

\newcommand{\mat}[4]{\begin{pmatrix}#1&#2\\#3&#4\end{pmatrix}}

\usepackage[backend=biber, bibencoding=utf8]{biblatex}
\bibliography{matrix}

\title{Minimal generating sets for matrix monoids}
\author{F. Hivert, J. D. Mitchell, F. L. Smith, and W. A. Wilson}
\date{\today}
\begin{document}

\maketitle

\begin{abstract}
  TODO
\end{abstract}

\section{Introduction}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%The \defn{boolean semiring} $\B$ is the set $\{0, 1\}$ with addition defined by 
%\begin{align*}
%  0 + 1 = 1 + 0 &= 1 + 1 = 1 \\
%  0 + 0 &= 0
%\end{align*}
%and multiplication defined as usual for the real numbers $0$ and $1$.  The
%addition and multiplication of elements of $\B$ naturally extends to row and
%column vectors of equal length with entries in $\B$.  The main object of study
%in this document is the collection $\Bn$ of $n\times n$ matrices with entries in
%$\B$. Under the usual multiplication of matrices, using addition and
%multiplication in $\B$, the set $\Bn$ forms a monoid; call the \defn{full
%  boolean matrix monoid}. The monoid $\Bn$ is classical in the literature of
%semigroup theory being among the first monoids to be studied; see, for example,
%\cite{Zaretskii1963aa}. The monoids $\Bn$, $n\in \N$, have been extensively
%studied in the literature, by many authors, and a great deal is known about its
%structure and properties. For example, if $G$ is a finite group, then there
%exists an $n\in \N$ such that $G$ occurs as a maximal subgroup of $\Bn$; the
%probability that a random product of matrices in $\Bn$ equals the universal
%matrix:
%\begin{equation*} 
%  \begin{pmatrix}
%  1 & 1 & \cdots & 1\\
%  1 & 1 & \cdots & 1\\ 
%  \vdots & \vdots & \ddots & \vdots\\
%  1 & 1 & \cdots & 1\\ 
%\end{pmatrix} 
%\end{equation*} 
%tends to $1$ as $n\to \infty$; the minimal size of a generating set for $\Bn$
%grows exponentially with $n$ (see~\thref{lem:exponentialgensets});
%Devadze~\cite{Devadze1968aa} and Konieczny~\cite{Konieczny2011aa} characterise
%minimum cardinality generating sets for $\Bn$; TODO: more.
%
%Despite its venerable status, many aspects of the monoids $\Bn$ are still
%shrouded in mystery. The purpose of this article is to cast some light on the
%problems of determining the minimum cardinality $\mathbf{d}(\Bn)$ of a
%generating set for $\Bn$ and certain submonoids of $\Bn$ such as the reflexive
%boolean matrix monoid $\Refn$, and other submonoids where the matrices contain
%particular matrices.
%% The time and space complexity of determining any of these value is exponential
%% in $n$. 
%It seems unlikely that an explicit formula for any of these numbers exists.
%In this paper we describe algorithms for computing the numbers listed,
%and the output of our implementation~\cite{} of these algorithms. The latter
%are summarised in Figures~\ref{figure-table-1} and \ref{fig:reflexiverank}.
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Preliminaries}
\label{section-preliminaries}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Green's relations}
On any semigroup $S$, there are some key equivalence relations. These are known
as Green's relations, and are defined in terms of principal ideals as follows.
Let $S$ be any semigroup and let $s, t \in S$. Then
\begin{align*}
  s \L t &\text{ if and only if } S^1 s = S^1 t \\
  s \R t &\text{ if and only if } s S^1 = t S^1 \\
  s \J t &\text{ if and only if } S^1 s S^1 = S^1 t S^1.
\end{align*}
Finally, we define Green's $\H$-relation as the intersection of $\L$ and $\R$.
We write $X_s$ for the Green's $\mathcal{X}$-class of $s$, where
$\mathcal{X} \in \{\L, \R, \J, \H\}$.
There is a natural partial order on certain Green's classes
\begin{align*}
  R_s \leq R_t &\text{ if and only if } sS^1 \subseteq tS^1 \\
  L_s \leq L_t &\text{ if and only if } S^1s \subseteq S^1t \\
  J_s \leq J_t &\text{ if and only if } S^1 s S^1 \subseteq S^1 t S^1.
\end{align*}
Further background on Green's relations can be found in~\cite{Howie1995aa}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Semirings}
The theory of matrices over fields is familiar and well-studied, but we are
concerned with matrices over more general objects, semirings. For our purposes,
a semiring is a set $R$ with two operations, $\oplus$ an $\otimes$, such
that $(R, \oplus)$ forms a commutative monoid with identity $e$, $(R, \otimes)$ forms
a monoid, $e\otimes x = x\otimes e = e$ for all $x \in R$,  and multiplication
distributes over addition. We call the additive identity the \defn{zero} of the
semiring and the multipicative identity the \defn{one}. We are particularly
interested in several special types of semiring.

The \defn{boolean semiring} $\B$ is the set $\{0, 1\}$ with addition defined by 
\begin{align*}
  0 \oplus 1 = 1 \oplus 0 &= 1 \oplus 1 = 1 \\
  0 \oplus 0 &= 0
\end{align*}
and multiplication defined as usual for the real numbers $0$ and $1$. This
semiring, and the matrices over it, have been studied since Zaretskii's
foundational paper~\cite{Zaretskii1963aa} in 1963. \\

The \defn{min-plus semiring} $K^{\infty}$ is the set $\N \cup \{\infty\}$, with
$\oplus = \min$ and $\otimes$ extending the usual addition on $\N$ so that
$x\otimes\infty = \infty\otimes x = \infty$ for all $x \in K^{\infty}$. For our
purposes, $0 \in \N$, and so the one of $K^{\infty}$ is $0$ and the zero is
$\infty$. \\ 
%The min-plus semiring was first introduced by
%Simon~\cite{Simon1978aa} in the context of automata theory; see also
%Pin~\cite{Pinab}. 
The \defn{max-plus semiring} $K^{-\infty}$ is the set $\N \cup \{-\infty\}$ with
$\oplus = \max$ and $\otimes$ extending the usual addition on $\N$ so that
$x\otimes-\infty = -\infty\otimes x = -\infty$ for all $x \in K^{-\infty}$. The
one of $K^{-\infty}$ is $0$ and the zero is $-\infty$.

We are also interested in certain finite quotients of these semirings. The
\defn{min-plus semiring with threshold $t$}, denoted $K^{\infty}_t$, is the set
$\{0, 1, \ldots, t, \infty\}$ with operations $\oplus = \min$ and $\otimes$
defined by
\begin{align*}
  a \otimes b = \begin{cases}
    \min(t, a + b) \quad &\text{$a \neq \infty$ and $b \neq \infty$} \\
    \infty \quad &\text{$a = \infty$ or $b = \infty$}.
  \end{cases}
\end{align*}

The \defn{max-plus semiring with threshold $t$}, denoted $K^{-\infty}_t$, is
constructed analogously; its elements are $\{-\infty, 0, 1, \ldots, t\}$,
addition is $\max$, and multiplication is defined by $a \otimes b = \min(t, a +
b)$ for all $a, b$.

These finite semirings with threshold $t$ may also be defined as the quotient of
the corresponding infinite semirings by the congruence generated by $(t, t +
1)$.

The min-plus and max-plus semirings are known as \defn{tropical} semirings.
Tropical semirings have attracted significant attention recently due to ???
TODO, see TODO.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Matrix semigroups}
\label{sec:matsemigp}
Given a semiring $R$, we are interested in the multiplicative monoid of square
matrices of dimension $n \in \N$ over that semiring, denoted by $M_n(R)$.  There
are a number of common features of such matrix monoids. As usual, we let $0$
denote the additive identity of $R$ and $1$ denote the multiplicative identity.

Let $A \in M_n(R)$. We write $A_{i*}$ to denote the $i$th row of $A$, and
$A_{*i}$ to denote the $i$th column. The \defn{row space} $R(A)$ of $A$ is the
set of all linear combinations of the rows of $A$. A \defn{row basis} of $A$ is
a linearly independent spanning set for the row space of $A$. \defn{Column
  spaces} and \defn{column bases} are defined dually. The importance of row and
column bases arises from the following well-known results~\cite{TODO}:

\begin{prop}
  \thlabel{prop:rowsandideals}
  Let $A, B \in M_n(R)$. Then the following hold:
  \begin{enumerate}[label=\roman*]

    \item
      If $R(A) \subseteq R(B)$, then $A \in M_n(R) B$.  Similarly, if $C(A)
      \subseteq C(B)$, then $A \in B M_n(R)$.

    \item 
      $R(AB) \subseteq R(B)$ and $C(AB) \subseteq C(B)$.
  \end{enumerate}
\end{prop}
\begin{proof}
  \noindent \textbf{(i).}
  If $R(A) \subseteq R(B)$, then every row of $A$ can be expressed as a linear
  combination of rows of $B$. For $1 \leq i \leq n$ of $A$, let $A_{i*} =
  \sum_{j = 1}^{n}x_{ij}B_{j*}$, and define $X = [x_{ij}]$. Then $A = XB \in
  M_n(R)B$. The other case is dual.
  \bigskip

  \noindent \textbf{(ii).}
  Suppose that $A = [\alpha_{ij}]$ and $B = [\beta_{ij}]$. If 
  $AB = [\gamma_{ij}]$, then 
  \[
  \gamma_{ij} = \alpha_{i1} \beta_{1j} + \alpha_{i2}\beta_{2j} 
                + \cdots + \alpha_{in}\beta_{nj}
              = \sum_{k = 1} ^ {n} \alpha_{ik}\beta_{kj}.
  \]
  It follows that the $i$th row of $AB$ is 
  \[
  (\gamma_{i1}, \gamma_{i2}, \ldots, \gamma_{in})
   =  \left (\sum_{k = 1} ^ {n} \alpha_{ik}\beta_{k1},
     \sum_{k = 1} ^ {n} \alpha_{ik}\beta_{k2},
     \ldots, 
     \sum_{k = 1} ^ {n} \alpha_{ik}\beta_{kn}\right) \\
   % & = & (\alpha_{i1}\beta_{11} + \alpha_{i2}\beta{21} + \cdots +
   %  \alpha_{in}\beta{n1},
   %  \alpha_{i1}\beta_{12} + \alpha_{i2}\beta{22} + \cdots +
   %  \alpha_{in}\beta{n2},
   %  \ldots,
   %  \alpha_{i1}\beta_{1n} + \alpha_{i2}\beta{2n} + \cdots +
   %  \alpha_{in}\beta{nn}) \\
   % & = & 
   % (\alpha_{i1}\beta_{11}, \alpha_{i1}\beta_{12}, 
   % \ldots, \alpha_{i1}\beta_{1n})
   % + 
   % (\alpha_{i2}\beta_{21}, \alpha_{i2}\beta_{22}, 
   % \ldots, \alpha_{i2}\beta_{2n})
   % + \cdots +
   % (\alpha_{in}\beta_{n1}, \alpha_{in}\beta_{n2}, 
   % \ldots, \alpha_{in}\beta_{nn}) \\
    =
    \sum_{k = 1} ^ {n} 
    \alpha_{ik}B_{k*}.
  \]
  Thus the $i$th row of $AB$ is a sum of rows of $B$, and so $R(AB) \subseteq
  R(B)$. 
\end{proof}

\begin{prop} 
  \thlabel{lem:GreensRowColumnSpaces}
  Let $A, B \in M_n(R)$. Then the following are equivalent:
  \begin{enumerate}[label=\roman*]
    \item 
      $A \L B$;

    \item 
      $R(A) = R(B)$;
  \end{enumerate}
  An analogous statement holds for Green's $\R$-relation using column spaces. 
\end{prop}
\begin{proof}
  \textbf{(i) $\Rightarrow$ (ii).} 
  If $A \L B$, then there are 
  $X, Y \in \Bn$ such that $XA = B$ and $YB = A$. Then $R(B) = R(XA) \subseteq
  R(A)$ and $R(A) = R(YB) \subseteq R(B)$ by
  Proposition~\ref{prop:rowsandideals}(ii).
  \bigskip

  \textbf{(ii) $\Rightarrow$ (i).} Follows immediately by
  Proposition~\ref{prop:rowsandideals}(i). 
\end{proof}

The \defn{group of units} of $M_n(R)$ is the group of invertible matrices
(\defn{units}) over $R$; the identity matrix is always a unit. The group of
units is always the maximal class in the $\J$-order.

For any semiring $R$, the symmetric group embeds into the group of units of
$M_n(R)$ by the map 
\begin{align*}
  \phi:\: &\alpha \to [a_{ij}], \\
  &a_{ij} =
    \begin{cases}
      1 \quad & i\alpha = j \\ 
      0 \quad &\text{otherwise}.
    \end{cases}
\end{align*}
The image of this embedding will often simply be referred to as $S_n$ or the
symmetric group when context prevents ambiguity.

Two matrices $A, B\in M_n(R)$ are \defn{similar} if each can be obtained from
the other by permuting the rows and/or columns. Note that similar matrices are
$\J$-related in $M_n(R)$, by multiplying on the left and/or right by permutation
matrices.

\begin{de}[\textbf{Prime matrices.}]
  A non-unit matrix $A \in M_n(R)$ is \defn{prime} if $A = BC$ implies $B$ or
  $C$ is a unit.
\end{de}

The prime matrices of $M_n(R)$ are immediately below the group of units in the
$\J$-order. TODO: justify 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Minimal generating sets}

Given a semigroup $S$, we may ask what the minimum cardinality is of a
generating set for $S$. This is known as the \defn{rank} of $S$ and is denoted
by $\mathbf{d}(S)$. A generating set $X$ for $S$ is \defn{irredundant} if no
subset of $X$ generates $S$, and we say that any irredundant generating set of
cardinality $\mathbf{d}(S)$ is a \defn{minimal generating set}.

\begin{de}[\textbf{Indecomposable elements}]
  An element $x$ of a monoid $M$ with identity $e$ is \defn{decomposable} if
  there exist $y, z \in M$ with $x = yz$, and \defn{properly decomposable} if
  there exist $y, z \in M\setminus\{e, x\}$ such that $x = yz$.
\end{de}

\begin{lemma}
  Let $S$ be a finite semigroup and let $X$ be a set of elements which generate
  all elements of the maximal $\J$-classes of $S$. Suppose that for all $A$ not
  in the maximal $\J$-classes of $S$, $A$ can be written as a product of
  elements which lie strictly above $A$ in the $\J$-order. Then $X$ generates
  $S$. 
\end{lemma}
\begin{proof}
  easy, will fill in after rearrangement
\end{proof}

\begin{prop}[Wilf, elsewhere]
  \thlabel{prop-wilf}
  Let $S$ be a finite semigroup.  Suppose that $X$ is an irredundant generating
  subset of $S$ that contains at most one element from each $\D$-class of $S$.
  Then $X$ has minimal cardinality, i.e. $\rank(S) = |X|$.
\end{prop}
\begin{proof}
  Wilf claims to have proven this.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Boolean Matrix Monoids}
\label{sec:boolmat}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Boolean matrices}

We now consider the case of the Boolean semiring, and the matrix monoid $\Bn$.
Some of the results of Section~\ref{sec:matsemigp} may be strengthened for
$\Bn$, and there are a number of additional useful concepts.
We first note that each row or column of a matrix $A \in \Bn$ may be viewed
as the characteristic function of a subset of $\{1, \ldots, n\}$. Since there is
a single non-zero element of $\B$, we may talk of \defn{unions} of rows rather
than linear combinations. Given $\alpha, \beta \in \B^n$, we also say that
$\alpha$ is \defn{contained} in $\beta$, and write that $\alpha \leq \beta$, if
for every position $i$ such that $\alpha_i = 1$, the entry $\beta_i$ is also
$1$. 

It is straightforward to verify that if $A \in \Bn$, then there is a unique row
basis $r(A)$, which is the unique minimal generating set for $R(A)$ under
union. The dual statement for column spaces also holds. This yields a
strengthening of \thref{lem:GreensRowColumnSpaces}.

\begin{prop} 
  \thlabel{lem:BMatGreensRowColumnBases}
  Let $A, B \in \Bn$. Then the following are equivalent:
  \begin{enumerate}[label=\roman*]
    \item 
      $A \L B$;
    \item 
      $r(A) = r(B)$.
  \end{enumerate}
  An analogous statement holds for Green's $\R$-relation using column spaces
  and bases. 
\end{prop}

It is significantly more difficult to determine the $\J$-relation than the $\L$-
or $\R$-relation. In order to describe it, we must introduct the concept of
\defn{row space embeddings}: a function $f: R(A) \to R(B)$ is a row space
embedding if it respects containment and non-containment, i.e.\ $f(v) \leq f(w)$
if and only if $v \leq w$.
\begin{thm}[Zaretskii's Theorem~\cite{Zaretskii1963aa}]
  \thlabel{thm:Zaretskii}
  Let $A, B \in \Bn$. Then $A \leq_{\J} B$ if and only if there exists a row
  space embedding $f: R(A) \to R(B)$.
\end{thm}

The following concept is useful when attempting to decompose boolean matrices as
products.
\begin{de}[\textbf{Greedy multipliers}]
  Given two matrices $A, B \in \Bn$, we say that the \emph{greedy
  left [right] multiplier} of $A$ w.r.t. $B$ is the matrix $C$ containing a $1$
  in position $(i, j)$ if and only if $A_j \leq B_i$ [$A^T_i \leq B^T_j$].
\end{de}

Given an expression of the form $CA = B$, we will often simply say that
\emph{$C$ is the greedy multiplier} if $C$ is the greedy left multiplier
of $A$ w.r.t $B$; the dual is also true.

Considering rows as subsets of $\{1, \ldots, n\}$ leads naturally to the
following concepts:

\begin{de}[\textbf{Reduced matrices}]
  A matrix $A \in \Bn$ is \emph{row-reduced} if no row of $A$ can be written as
  a union of other rows of $A$. \emph{Column-reduced} is defined dually. We say
  that $A$ is \emph{reduced} if it is both row-reduced and column-reduced.
\end{de}

\begin{de}[\textbf{Trim matrices}]
  A matrix $A \in \Bn$ is \emph{row-trim} if no non-zero row of $A$ is contained in
  another row. \emph{Column-trim} is defined dually. We say that $A$ is
  \emph{trim} if it is both row-trim and column-trim.
\end{de}

\begin{lemma}
  \thlabel{lem:TrimMatricesAreReduced}
  Every trim matrix is reduced.
\end{lemma}
\begin{proof}
  Since no row of a reduced matrix is contained in another row, no row can be
  expressed as a union of other rows; the same argument applies to columns.
\end{proof}

The following results is one of the key reasons to be interested in trim and
reduced matrices.

\begin{lemma}[\cite{Konieczny2011aa}]
  \thlabel{lem:PrimeMatricesAreTrim}
  Every prime matrix is trim.
\end{lemma}
\begin{proof}
  Let $A \in \Bn$ be prime. Suppose some non-zero row $k$ of $A$ is contained in
  a row $l$ of $A$. Then $XA = A$, where $X$ is the greedy left multiplier, and
  since $|X_l| \geq 2$, $X \not\in S_n$, a contradiction. A dual argument shows
  that no non-zero column of $A$ is contained in another column.
\end{proof}

Reduced matrices are particularly convenient to compute with, due to the
following lemma. 
\begin{lemma}[\cite{Plemmons1970aa}]
  \thlabel{lem:PermutingReducedMatrices}
  Let $A, B \in \Bn$ be reduced. Then $A \J B$ if and only $A$ and $B$ are
  similar.
\end{lemma}

This result allows us to find single representatives of the $\J$-classes of
reduced matrices by computing a canonical image under row and column
permutations. Note that the problem of detecting if two boolean matrices are
$\J$-related is in general NP-hard~\cite{Fenner2018aa}. It also implies that the
$\J$-class of any prime matrix $P$ consists of prime matrices similar to $P$,
and we refer to such a $\J$-class as a \defn{prime $\J$-class}. \\

This paper is concerned with generating sets for matrix monoids. Unfortunately
it is known that the size of a minimal generating set for $\Bn$ grows very
quickly with $n$; see~\thref{lem:exponentialgensets}.\\

In contrast, the subsemigroup of $\Bn$ generated by all the regular elements can
be generated by the four matrices \cite{Roush1977aa}

\begin{align*}
  T = \begin{pmatrix}
    0 & 1 & 0 & 0 & \cdots & 0 \\
    1 & 0 & 0 & 0 & \cdots & 0 \\
    0 & 0 & 1 & 0 & \cdots & 0 \\
    0 & 0 & 0 & 1 & \cdots & 0 \\
    \vdots  & \vdots & \vdots & \vdots & \ddots & \vdots\\
    0 & 0 & 0 & 0 & \cdots & 1 
  \end{pmatrix}\text{, }&
  U = \begin{pmatrix}
    0 & 1 & 0 & 0 & \cdots & 0 \\
    0 & 0 & 1 & 0 & \cdots & 0 \\
    0 & 0 & 0 & 1 & \cdots & 0 \\
    0 & 0 & 0 & 0 & \cdots & 0 \\
    \vdots  & \vdots & \vdots & \vdots & \ddots & \vdots\\
    1 & 0 & 0 & 0 & \cdots & 0 
  \end{pmatrix},&\\
  E = \begin{pmatrix}
    1 & 0 & 0 & 0 & \cdots & 0 \\
    1 & 1 & 0 & 0 & \cdots & 0 \\
    0 & 0 & 1 & 0 & \cdots & 0 \\
    0 & 0 & 0 & 1 & \cdots & 0 \\
    \vdots  & \vdots & \vdots & \vdots & \ddots & \vdots\\
    0 & 0 & 0 & 0 & \cdots & 1 
  \end{pmatrix}\text{, }&
  F = \begin{pmatrix}
    0 & 0 & 0 & 0 & \cdots & 0 \\
    0 & 1 & 0 & 0 & \cdots & 0 \\
    0 & 0 & 1 & 0 & \cdots & 0 \\
    0 & 0 & 0 & 1 & \cdots & 0 \\
    \vdots  & \vdots & \vdots & \vdots & \ddots & \vdots\\
    0 & 0 & 0 & 0 & \cdots & 1
  \end{pmatrix}.
\end{align*}
We will continue to use these names for these matrices throughout
Section~\ref{sec:boolmat}. Note that together $T$ and $U$ generate $S_n$.

We call any matrix similar to $E$ an \defn{elementary} matrix, and call the
$\J$-class $J_E$ the \defn{elementary $\J$-class}. The elementary matrix which
consists of the identity matrix with an additional $1$ in position $j$ of the
$i$th row will be denoted by $E^{i,j}$.

The prime matrices of $M_n(R)$ sit directly below the group of units in
$\J$-order on $M_n(R)$ for any semiring $R$. In the case of $\Bn$, there is a
single extra $\J$-class immediately below $S_n$: $J_E$. Note that $J_F \leq
J_E$. The next result shows that in fact these are all of the $\J$-classes
immediately below $S_n$.

Let $\beta_n$ denote the set $\set{R(A)}{A\in \Bn\setminus S_n}$ of all
possible proper row subspaces of elements of $\Bn$, and let $\B^n$ denote
the space of all boolean vectors of length $n$. Note that $\B^n$ is the
row/column space of precisely the permutation matrices.

\begin{thm}[cf. Theorem 5.1 in~\cite{Caen1981ab}]
  \thlabel{thm:MaximalRowSpaces}
  Let $A \in \Bn\setminus S_n$. Then $R(A)$ is maximal with respect to
  containment in $\beta_n$ if and only if $A$ is prime or elementary.  
\end{thm}

For the full Boolean matrix monoid $\Bn$, a minimal generating set was stated by
Devadze in 1968~\cite{TODO}; the first published proof is due to Konieczny in
2011.

\begin{thm}[Devadze's Theorem \cite{Konieczny2011aa}]
  \thlabel{thm:DevadzeKon}
  Let $P$ be any set of representatives of the prime D-classes of $\Bn$. Then
  the set $\{T, U, E, F\} \cup P$ is a generating set of minimum cardinality for
  $\Bn$.
\end{thm}

In fact, we may state Devadze's theorem in a slighty stronger form.
\begin{thm}[Devadze's Theorem \cite{Konieczny2011aa}]
  \thlabel{thm:Devadzefull}
  Any minimal generating set for $\Bn$ is given by $\{T', U', E', F'\} \cup P$,
  where $T'$ and $U'$ generate $S_n$, $E'$ is elementary, $F'$ is a matrix
  similar to $F$, and $P$ is a set of representatives of the prime $\J$-classes
  of $\Bn$. Conversely, any such set generates $\Bn$.
\end{thm}
\begin{proof}
  The converse follows immediately from \thref{thm:DevadzeKon}, noting that $A
  \in \genset{\{A', T', U'\}}$ for any similar matrices $A, A' \in \Bn$.

  Let $X$ be a minimal generating set for $\Bn$. Since $\mathbf{d}(S_n) = 2$,
  and $X$ must contain generators of the group of units $S_n$, it follows that
  $X$ contains two elements which together generate $S_n$, which we denote by
  $T'$ and $U'$. By \cite[Lemma 4.2]{Konieczny2011aa}, $X$ also contains a set
  $P$ of representatives of the prime $\J$-classes of $\Bn$. By \cite[Lemma
  4.5]{Konieczny2011aa}, and the fact that the elementary $\J$-class lies
  immediately below the group of units, $X$ must also contain an elementary
  matrix, say $E'$. It only remains to show that $X$ must contain a matrix
  similar to $F$. Since none of the elements of $P$, nor $E'$, contain a
  zero row, $P \cup \{E'\}$ does not generate $F$, and $X$ must contain a matrix
  with at least one zero row. Since matrices similar to $F$ have the maximal row
  spaces amongst matrices containing zero rows, $X$ must contain a matrix
  similar to $F$.
\end{proof}

\begin{cor}
  \thlabel{lem:exponentialgensets}
  The size $\mathbf{d}(\Bn)$ of a minimal generating set for $\Bn$ grows
  exponentially with $n$.
\end{cor}
\begin{proof}
  This follows from the fact that there at least $2^{\frac{n^2}{4} - O(n)}$
  prime boolean matrices in $\Bn$ (see~\cite[Theorem 2.4.1]{Kim1982aa}) and each
  prime $\J$ class contains at most $(n!)^2$ elements; hence there are
  exponentially many prime $\J$-classes.
\end{proof}

\subsection{The Full Boolean Matrix Monoid}

By Devadze's Theorem, in order to compute minimal generating sets for $\Bn$ it
is sufficient to compute sets of representatives of the prime $\J$-classes of
$\Bn$. We shall call such a set a \emph{canonical} set of prime matrices, and in
general we shall call any set containing at most one representative of each
$\J$-class a \defn{canonical set}. In particular, we refer to a canonical set of
matrices containing a canonical set of prime matrices as a canonical superset of
prime matrices. In this section we compute minimal generating
sets for $\Bn$ for $1 \leq n \leq 8$.  The rank of $\Bn$ for $1 \leq n \leq 8$
is shown in
Figure~\ref{figure-table-1}.
\begin{figure}
  \centering
  \begin{tabular}{l|r|r}
    $n$ & $\mathbf{d}(\Bn)$ &   \\
    \hline
    1 & 2          & - \\ 
    2 & 3          & - \\ 
    3 & 5          & - \\ 
    4 & 7          & - \\
    5 & 13         & ? \\
    6 & 68         & \cmark \\ 
    7 & 2\ 143     & \cmark \\
    8 & 495\ 115   & \cmark \\
  \end{tabular}
\vspace{1cm}

  \caption{The rank $\mathbf{d}(\Bn)$ of a generating set for the monoid
  of all $n \times n$ boolean matrices, where: 
  ``-'' indicates a value that can be computed by hand or brute force;
  ``\cmark'' indicates that the value was first found here.}
  \label{figure-table-1}
\end{figure}

We say that a function $\phi: \Bn \to \Bn$ is a \defn{canonical form} if
$\ker\phi = \J$. We then wish to enumerate the values $\{\phi(A) :\: \text{$A$
    prime}\}$ for some canonical form $phi$.

Broadly, our strategy will be to enumerate a certain canonical superset of prime
matrices, and then filter this superset. It is infeasible to compute
individually with each of the $2^{n^2}$ elements of $\Bn$, or even all of the
prime matrices of $\Bn$. We instead work with matrices of a certain form. 

\begin{prop}[\cite{Breen1997aa}]
  \thlabel{prop:StandardFormProperties}
  In every $\J$-class $J_A$ of $\Bn$, there exists a matrix in \emph{standard
    form} with the following properties:
  \begin{itemize}
  \item{$A$ is reduced,}
  \item{all non-zero rows of $A$ are at the bottom,}
  \item{all non-zero columns of $A$ are at the right,}
  \item{the non-zero rows of $A$ as binary numbers are a strictly increasing
      sequence, as are the columns}
  \item{all ones in the first non-zero row of $A$ are on the right,}
  \item{all ones in the first non-zero column of $A$ are at the bottom,}
  \item{every non-zero row has at least as many ones as the first non-zero row.}
  \end{itemize}
\end{prop}

Each of these properties can be viewed as an attempt to minimise the value of
the matrix in its $\J$-class when considered as a binary number. Unfortunately,
having these properties is not enough to guarantee that the matrix is minimal
(although the minimal matrix in a $\J$-class has these properties), so standard
form is not a canonical form for boolean matrices.

\begin{ex}
Let
\begin{align*}
  A = \begin{pmatrix}
    1 & 0 & 0 & 0 & 1 \\
    0 & 1 & 0 & 1 & 0 \\
    0 & 0 & 1 & 1 & 1 \\
    1 & 0 & 1 & 1 & 0 \\
    0 & 1 & 1 & 0 & 1 
  \end{pmatrix}\text{,}&
  B = \begin{pmatrix}
    1 & 0 & 1 & 0 & 0 \\
    0 & 1 & 0 & 1 & 0 \\
    0 & 0 & 1 & 1 & 1 \\
    1 & 0 & 0 & 1 & 1 \\
    0 & 1 & 1 & 0 & 1 
  \end{pmatrix}.&\\
\end{align*}
Then $A$ and $B$ are in the standard form of
\thref{prop:StandardFormProperties}. Swapping rows $1$ and $2$ and columns $3$
and $4$ shows that $A$ and $B$ are similar, and hence are $\J$-related.
\end{ex}

Enumerating matrices in canonical form is challenging, but enumerating matrices
in standard form is more straightforward. Given the set $S$ of matrices in
standard form in $\Bn$, and a canonical form $\phi$, the image $Q = \phi(S)$ is
a canonical superset of prime matrices. We will discuss several methods
of filtering $Q$ to obtain the prime matrices desired later in this section. We
first describe how to obtain the set $S$ using a backtrack search.

Given a matrix $A \in \Bn$, we may form the bipartite graph $\Gamma(A)$ with
biadjacency matrix $A$; i.e. $\Gamma(A)$ has vertices $\{1 \ldots 2n\}$ and an
edge from $i$ to $j+n$ if and only if $A_{ij} = 1$. Then $\{1, \ldots, n\}$
represent rows and $\{n + 1, \ldots, 2 * n\}$ represent positions. It is easy to
see that $\Gamma$ is a bijection from $\Bn$ to the set $\BGSet$ of bipartite
graphs with two parts of size $n$. We call a function $\psi: \BGSet \to \BGSet$
a canonical form for $\BGSet$ if $\ker\psi$ is the isomorphism classes of
$\BGSet$. Computing canonical forms for graphs is a well-studied problem (see
TODO) and we use \cite{TODO:bliss} to obtain such a function $\psi$. 
\begin{lemma}
  The function $\phi = \Gamma^{-1}\psi\Gamma$ is a canonical form when
  restricted to reduced matrices. 
\end{lemma}
\begin{proof}
  We must show that $\ker\phi = \J$, i.e. $\phi(A) = \phi(B)$ if and only if
  $A\J B$. This is equivalent to showing $\Gamma(A)$ is isomorphic to
  $\Gamma(B)$ if and only if $A \J B$. Denote the vertices of $\Gamma(A)$ by
  $\{1, \ldots, 2 * n\}$ and the vertices of $\Gamma(B)$ by $\{1', \ldots,
    2n'\}$, as above.
  Suppose that there is an isomomorphism $\Psi: \Gamma(A) \to \Gamma(B)$. We may
  assume that $\Psi$ maps $\{1, \ldots, n\} \to \{1', \ldots, n'\}$, since... 
\end{proof}

Given $v \in \B^n$, it will convenient to denote the number represented by $v$
in binary as $\bar{v}$. We will also write $n^\dagger$ to denote the boolean
vector $v \in \Bn$ such that $\bar{v} = n$.

We now describe how to backtrack through matrices in standard form to find a
canonical superset of prime matrices. This may be seen as a depth-first
traversal of a tree $Y$, with nodes partially-completed matrices and leaves
fully-completed matrices.
\begin{alg}
  \thlabel{alg:canonicalbacktrack}
  \ \\
  \textbf{Input}: A natural number $n$. \\
  \textbf{Output}: A canonical superset of prime matrices of $\Bn$.
  \begin{enumerate}
    \item We assume that we are at a node $v$, having chosen rows $1, \ldots, i$
      of a matrix $A$ such that the first non-zero row is row $f < i$. 
    \item If $v$ is not a leaf of $Y$, then for each $x \in \{\bar{A_{i*}} + 1,
        \ldots, (2^n - 1)^\dagger\}$, if:
      \begin{itemize}
        \item $x^\dagger$ has at least as many ones as $A_{f*}$,
        \item $x^\dagger$ is not in the row space of $A$,
        \item $x^\dagger$ does not contain $A_{l*}$ for any $1 \leq l \leq i$,
          and
        \item for all positions $j < k$ such that $x^\dagger_j = 1$ and
          $x^\dagger_k = 0$, there is a $1$ in positions $j, j + 1, \ldots, k$
          of $(\cup_{1 \leq l \leq i}A_{l*}) \cup x^\dagger$, then:
      \end{itemize}
      set $A_{(i + 1)*} = x^\dagger$, and return to step 1.
    \item If $v$ is a leaf, and $A$ is column-reduced, then add $\phi(A)$ to
      $Q$, the set of matrices to return.
  \end{enumerate}
  Having initialising step $1$ with each partial matrix consisting of a number
  (possibly $0$) zero rows followed by a row containing $1$s on the right,
  return $Q$.
\end{alg}

\begin{lemma}
  \thlabel{lem:backtrackworks}
  The output of \thref{alg:canonicalbacktrack}, with input $n$, is a canonical
  superset of prime matrices of $\Bn$.
\end{lemma}  
\begin{proof}

\end{proof}

Given canonical superset $Q$ of prime matrices $P$, we wish to detect
when an element of $Q$ is prime. We present two algorithms for doing so, in
\thref{alg:filter1} and \thref{alg:filter2}.

\begin{alg}
  \thlabel{alg:filter1}
  \ \\
  \textbf{Input}: A canonical superset $Q$ of prime matrices $P$, which does not
  contain a permutation matrix.\\
  \textbf{Output}: The set $P$.
  \begin{enumerate}
  \item 
    Compute $R = \set{R(A\alpha)}{A \in (Q\setminus S_n) \cup \{E\}, \alpha \in S_n}$
  \item
    For every $A \in Q$, and for every $R(B\beta) \in R$, if $A \neq B$ and
    $R(A) \subsetneq R(B\beta)$ then discard $R(A\alpha)$ from $R$ for all
    $\alpha \in S_n$.
  \item
    Output $X\subset Q$, the set of non-elementary elements $A$ such that $R(A)$
    remains in $R$ after the previous step.
  \end{enumerate}
\end{alg}

\begin{lemma}
  The output of \thref{alg:filter1} is a canonical set of prime matrices.
\end{lemma}
\begin{proof}
  Since the $\J$-class of a prime matrix consists only of similar matrices, the
  set $\set{R(A\alpha)}{A \in P} \subset R$ contains all row spaces of prime
  matrices in $\Bn$, and hence so does $R$. Similarly, $R$ contains the row
  space of every elementary matrix. Hence, the elements that are maximal in $R$
  are precisely the maximal elements of $\beta_n$ and thus by
  \thref{thm:MaximalRowSpaces} correspond to primes and elementary matrices.
  Since $R(A)$ remains in $R$ after step 2 precisely when $R(A)$ (and
  $R(A\alpha)$, for all $\alpha \in S_n$) is maximal in $R$, the output is a
  canonical set of prime matrices as required.
\end{proof} 

Note that step 2 of \thref{alg:filter1} requires $O(|Q||R|)$ comparisons.  The
size of $R$ grows extremely rapidly with $n$ as shown in
\ref{fig:filter1numbers}, and so this algorithm is only suitable for small $n$.
\begin{figure}
  \centering
  \begin{tabular}{l|r|r}
    $n$ & $|Q|$ & $|R|$ \\
    \hline
    3 & 6 & 91 \\ 
    4 & 11 & 588 \\
    5 & 33 & 8194 \\
    6 & 395 & 570\ 636 \\ 
    7 & 34\ 015 & 342\ 915\ 296 \\
    8 & 17\ 120\ 845 & ? 
  \end{tabular}
\vspace{1cm}
%TODO: verify these numbers and work out what's going on in the code

\caption{The number of row spaces generated during \thref{alg:filter1} when
  given input $Q$, the output of \thref{alg:canonicalbacktrack}} 
  \label{fig:filter1numbers}
\end{figure}

Using \thref{alg:canonicalbacktrack} and \thref{alg:filter1}, minimal
generating sets for $n \leq 7$ may be obtained.

For $n=8$ this algorithm is no longer sufficient. In this case it is necessary
to use heuristics to reduce the size of $R$. The simplest way to do this is to
select a small subset $X \subset Q$ of matrices with large row spaces, generate
the row spaces $Y = \{R(A\alpha) :\: A \in X\} \subset R$, and check whether $R(B)$
is contained in any element of $Y$ for each element $B \in X$.
It is also worthwhile to filter $R$ by checking containment in the row spaces of
all the column permutations of a known set of prime matrices, such as those
described in the following lemma.

\begin{lemma}
  \thlabel{lem:ExtendingPrimeMatrices}
  Let $A$ be a prime matrix in $M_{n-1}(\B)$. Extend $A$ to a matrix $B \in \Bn$
  by adding a row of zeros at the bottom and a column of zeros on the right,
  then setting $B_{n,n} = 1$. Then $B$ is prime in $\Bn$.
\end{lemma}
\begin{proof}
  We will show that $R(B)$ is maximal in $\beta_n$, by showing that if 
  $R(C) \in \beta_n$ contains $R(B)$, then $r(B) = r(C)$.
  Let $C$ be such a matrix.
  The last row of $B$ must also be in $C$ since it is a minimal in $\B^{n}$. 
  Now $R(A)$ has a unique basis of $n-1$ rows which must be contained in both $B$ and
  $C$, so we have $r(B) = r(C)$.
\end{proof}

For $n=8$ prefiltering by some of the large row spaces and extended prime
matrices is enough to obtain a minimal generating set, though the computation is
lengthy TODO:how lengthy?. A significant improvement can be obtained by using
Zaretskii's Theorem.

Let $A \in \Bn$. The \defn{graph} of $R(A)$ is the directed graph with vertices
$R(A)$ and an edge from $v$ to $w$ if $v \leq w$. The graph of $C(A)$ is defined
analogously.

It is an immediate corollary of Zaretskii's Theorem that $A \leq_{\J} B$ iff
there exists a homomorphic embedding of the graph of $R(A)$ into the graph of
$R(B)$ which respect non-edges. An efficient search for such embeddings is
implemented in~\cite{Digraphs2020aa}.

For practical computational purposes, it is useful to add extra structure to the
row space graphs to guide searches for embeddings. The \emph{augmented graph of
  $R(A)$} is the disjoint union of the graph of $R(A)$ with the empty graph on
the vertices $C = \{c_i \: : \: 1 \leq i \leq n\}$, with an edge from $v \in R(A)$
to $c_i$ if $v_i = 1$.

\begin{lemma}
  \thlabel{lem:EmbeddingGraphs}
  Let $Q$ be a superset of a canonical set of prime matrices $P$ which does not
  contain a permutation matrix, and let $A \in
  Q$. Then $A$ is not prime or elementary if and only if for some $B \in
  (Q\cup\{E\})\setminus\{A\}$ there exists a digraph embedding
  $\phi$ from the augmented graph of $R(A)$ into the augmented graph of $R(B)$
  which permutes $\{ c_i : 1 \leq i \leq n \}$ and respects non-adjacency.
\end{lemma}
\begin{proof}
  Let $A$ not be prime or elementary; then $R(A)$ is contained in the row space
  of some column permutation $\alpha$ of a $B \in Q \setminus \{A\}$.
  Then the embedding that extends the map $c_i \to c_{\alpha^{-1}i}$ has the
  properties required. Conversely, if such a map $\phi$ exists, the permutation
  $\alpha$ induced by the restriction to $C$ has the property that
  $R(B\alpha^{-1})$ contains $R(A)$, and hence by \thref{thm:MaximalRowSpaces}
  $A$ is not prime or elementary. 
\end{proof}

Note that such an embedding $\phi$ must also map a vector containing $i$ ones to
another containing $i$ ones to preserve adjacency and non-adjacency with the set
$C$.

We can therefore use the following improved algorithm to filter canonical
supersets of prime matrices.

\begin{alg}
  \thlabel{alg:filter2}
  \ \\
  \textbf{Input}: A canonical superset $Q$ of prime matrices $P$, which does not
  contain a permutation matrix.\\
  \textbf{Output}: The set $P$.
  \begin{enumerate}
  \item
    Generate the set $G$ of augmented graphs of row spaces of matrices in $Q$.
  \item 
    For every $K, L \in G$, if there exists an embedding of $K$ into $L$ as in
    \thref{lem:EmbeddingGraphs}, then discard $K$ from $L$.
  \item
    Output $X\subset Q$, the set of non-elementary elements $A$ with
    corresponding graphs remaining in $G$ after the previous step.
\end{enumerate}
\end{alg}

Note that this is in effect the same computation as in \thref{alg:filter1}; it
replaces a brute-force search through all permutations of columns with a guided
search for an appropriate permutation. It is also superior in that no more data
has to be computed, unlike \thref{alg:filter1} where new row spaces must be
produced for each column permutation. Additionally, information about the graphs
can be reused (in particular their automorphism group). However, this is not as
useful as it might seem, since the automorphism group of prime row spaces
appears to be almost always be trivial.

Using this method of filtration, minimal generating sets for $\Bm{8}$ have been
computed; the size of such generating sets is contained in
Figure~\ref{figure-table-1}. It seems unlikely that these methods can produce
minimal generating sets for $n > 8$. The generating sets obtained from this
algorithm are obtainable at TODO, along with code to produce them.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Reflexive Boolean Matrices}
An interesting submonoid of $\Bn$ is the monoid $\Refn$ of reflexive boolean
matrices, i.e. boolean matrices with $1$s on the main diagonal. Minimal
generating sets for $\Refn$ are significantly larger than those of $\Bn$; this
is essentially caused by the following well-known facts.

\begin{lemma}
  \thlabel{lem:reflexivecontainment}
  For any $A, B \in \Refn$, we have $A \leq A * B$ and $B \leq A * B$, with
  respect to containment.
\end{lemma}
\begin{proof}
  Since $A, B$ both contain the identity matrix, the product $A * B$ must
  contain both every row of $A$ and every column of $B$.
\end{proof}

\begin{lemma}
  \thlabel{lem:reflexivejtrivial}
  $\Refn$ is $\J$-trivial. 
\end{lemma}
\begin{proof}
  If $A \D B$, then $A \leq B$ and $B \leq A$ w.r.t containment. Hence $A = B$.    
\end{proof}

In order to determine generating sets for $\Refn$, we require the following results:


\begin{lemma}
  \thlabel{lem:reflexivegenstrimorelem}
  If $A$ is a non-trim, non-elementary matrix, then $A$ is properly
  decomposable.
\end{lemma}
\begin{proof}
Let $A$ be a non-trim, non-elementary matrix. Then $A$ has some row $i$
contained in some other row $j$. Let $B$ be the matrix obtained by setting entry
$i$ of row $j$ to be $0$. Then $B < A$ w.r.t containment, and letting $C$ be the
greedy left multiplier, $A = CB$. Hence $B, C > A$ in the $\J$-order. As $A$ is
non-elementary, $B$ and $C$ are non-identity matrices; hence $A$ is properly
decomposable.
\end{proof}

\begin{lemma}
  \thlabel{lem:reflexiveelementaryindecomposable}
  Elementary matrices are properly indecomposable in $\Refn$.
\end{lemma}
\begin{proof}
  Elementary matrices are precisely those matrices in $\Refn$ containing $n + 1$
  ones. Since non-identity matrices in $\Refn$ have at least $n + 1$ ones, by
  \thref{lem:reflexivecontainment} elementary matrices are not properly
  indecomposable.
\end{proof}

\begin{cor}
  \thlabel{cor:reflexiveindecomposable}
  Let $X$ denote the set of matrices in $\Refn$ that are not properly
  decomposable, $T \subset X$ denote the trim matrices in $X$, and $E$ denote
  the elementary matrices. Then $X \setminus T = E$. 
\end{cor}

\begin{lemma}
  The unique minimal (monoid) generating set for $\Refn$ is $T \cup E$.
\end{lemma}
\begin{proof}
  We first note that $T$ must be contained in any generating set for $\Refn$.
  Since the elements of $E$ are precisely those reflexive matrices containing
  $n + 1$ ones, \thref{lem:reflexivecontainment} implies that they are not
  properly decomposable and hence $E$ must be contained in any generating set.

  Now let $A \in \Refn$; we must show that $A \in \genset{T \cup E}$. If $A \in
  T \cup E$ then we are done, so suppose not. By
  \thref{lem:reflexivegenstrimorelem} and the definition of $T$, $A$ must be a
  properly decomposable matrix; say $A = BC$ for $B, C \in \Refn\setminus\{I,
  A\}$. By \thref{lem:reflexivejtrivial}, $B$ and $C$ are strictly above $A$ in
  the $\J$-order of $\Refn$. Now if $B$ or $C$ are not in $T \cup E$, we may
  again decompose to find elements still higher in the $\J$-order. Since $\Refn$
  has finite height, we must eventually not be able to properly decompose the
  elements we have found; by \thref{cor:reflexiveindecomposable} we have then
  found a decomposition of $A$ as a product of matrices in $T \cup E$.
\end{proof}

Given a matrix $A \in \Refn$, it is helpful to be able to determine whether $A$
is properly decomposable. The following lemmas suggest a method for doing so.

\begin{lemma}
  \thlabel{lem:greedymaximal}
  Given matrices $A, B \in \Bn$:
  \begin{enumerate}
    \item
      the greedy left multiplier $C$ of $A$ w.r.t $B$ is maximal w.r.t
      containment in the set $\set{X \in \Bn}{XA \leq B}$,
    \item 
      the product $CA$ is maximal w.r.t containment amongst products $XA$
      contained in $B$.
  \end{enumerate}
\end{lemma}
\begin{proof}
  Let $D \in \set{X \in \Bn}{XA = B}$, and suppose that row $i$ of $D$ contains
  a $1$ in position $j$. Then row $j$ of $A$ is contained in row $i$ of $B$, and
  hence $C$ has a $1$ in position $j$ of row $i$. Therefore $D \leq X$. The
  second part follows directly from this.
\end{proof}

\begin{lemma}
  \thlabel{lem:decomposeintersection}
  A trim matrix $A \in \Refn$ can be decomposed as $A = BC$, $B, C \in
  \Refn\setminus\{I, A\}$, if and only if $A = B'C'$ where $C'$ is the matrix
  whose $i$th row $C_i$ is the intersection 
  \[ C_i = \cap_{K_i} A_i \]
  where $K_i$ is the positions of the $1$s in the $i$th column of $B$, $B'$ is
  the greedy left multiplier, and $B', C' \in \Refn \setminus\{A\}$.
\end{lemma}
\begin{proof}
  ($\Rightarrow$)
  Suppose that $A = BC$ for $B, C \in \Refn \setminus\{I, A\}$, and let $B', C',
  K_i$ be defined as above. Fix $i$, and consider the $i^{\text{th}}$ row $C_i'$
  of $C'$. By the definition of $K_i$, for each $j \in K_i$, we have $C_i \leq
  A_j$; hence $C_i \leq C'_i \leq A_j$. This implies that $A = BC'$, since $A =
  BC \leq BC' \leq A$. By \thref{lem:greedymaximal}, $A = B'C'$, and $B' \in
  \Refn$ since $B \leq B'$. Since $C_i \leq C'_i$ for all $i$, $C'$ is also in
  $\Refn$. It remains to show that neither $B', C' \not\in \{I, A\}$. Note
  that since $B \leq B'$ (\thref{lem:greedymaximal}) and $C \leq C'$, $B', C'$
  are not the identity matrix. Since $A$ is trim, if $B'$ or $C'$ were equal
  to $A$ the product $B'C'$ would have more ones than $A$ does.\\
  ($\Leftarrow$) Immediate.
\end{proof}
Hence, in order to determine whether a trim matrix $A$ is decomposable it
suffices to:
\begin{enumerate}
  \item generate all matrices $C$ with rows intersections of rows of $A$, and
    for each $C$
  \item check whether the product $BC$ with the greedy left multiplier is equal
    to $A$, and $B, C \not\in \{I, A\}$.
\end{enumerate}
If no such matrices $B, C$ are found, then $A$ is indecomposable. This method is
clearly superior to checking all products of matrices in $\Refn$, but still may
require significant time.\\

In order to reduce the time spent checking matrices using
\thref{lem:decomposeintersection}, we would like to only check a smaller set of
canonical representatives. Unfortunately, the following two matrices illustrate
that two reflexive matrices can have the same canonical form under row and
column permutations in $\Bn$, while only one of them is decomposable in $\Refn$. 
\begin{ex}
  Let
\begin{align*}
  A = \begin{pmatrix}
    1 & 0 & 0 & 0 & 1 \\
    0 & 1 & 0 & 1 & 0 \\
    0 & 0 & 1 & 1 & 1 \\
    1 & 0 & 1 & 1 & 0 \\
    0 & 1 & 1 & 0 & 1 
  \end{pmatrix}\text{, }&
  B = \begin{pmatrix}
    1 & 0 & 1 & 0 & 0 \\
    0 & 1 & 0 & 1 & 0 \\
    0 & 0 & 1 & 1 & 1 \\
    1 & 0 & 0 & 1 & 1 \\
    0 & 1 & 1 & 0 & 1 
  \end{pmatrix}.&\\
\end{align*}
Then $A, B \in \Ref{5}$, and $B$ may be obtained by exchanging columns $3$ and
$5$ of $A$. However, $A$ is indecomposable whilst
\begin{align*}
  B = \begin{pmatrix}
    1 & 0 & 1 & 0 & 0 \\
    0 & 1 & 0 & 0 & 0 \\
    0 & 0 & 1 & 1 & 0 \\
    1 & 0 & 0 & 1 & 0 \\
    0 & 0 & 0 & 0 & 1 
  \end{pmatrix}
  \begin{pmatrix}
    1 & 0 & 0 & 0 & 0 \\
    0 & 1 & 0 & 1 & 0 \\
    0 & 0 & 1 & 0 & 0 \\
    0 & 0 & 0 & 1 & 1 \\
    0 & 1 & 1 & 0 & 1 
  \end{pmatrix}.&\\
\end{align*}
\end{ex} 

However, the following lemma shows that a more restricted form of
canonicalisation can be applied in $\Refn$:

\begin{lemma}
  \thlabel{lem:reflexivecanonical}
  Let $A, B \in \Refn$ be such that $A = P^{-1} B P$ for some permutation matrix
  $P \in S_n$ (i.e. $A$ is obtained by permuting the rows and columns of $B$ by
  the same permutation). Then $A$ is decomposable in $\Refn$ if and only if $B$
  is decomposable in $\Refn$.
\end{lemma}
\begin{proof}
  Suppose that $B = XY$ for $X, Y \in \Refn\setminus \{I, A\}$. Then $P^{-1}XP,
  P^{-1}YP \in \Refn\setminus\{I, A\}$ and $P^{-1}XPP^{-1}YP = A$. The proof of
  the other direction is dual, since $PAP^{-1} = B$.
\end{proof}

This means that it is sufficient to enumerate the trim reflexive matrices in the
following standard form:
\begin{itemize}
  \item{all $1$s in the first row of $A$ are on the left,}
  \item{no row has fewer ones than the first row,}
  \item{if a $1$ appears in row $i$ in column $j$, then for each $k < j$ there
      is some row $l < i$ with a $1$ in position $k$.}
\end{itemize}

We then have the following algorithm for finding a minimal generating set for
$\Refn$:
\begin{enumerate}
  \item
    Enumerate the trim reflexive boolean matrices in standard form using a
    backtrack search, storing canonical representatives under a row and column
    permutation in a set $S$
  \item 
    Filter out the properly decomposable matrices in $S$ using
    \thref{lem:decomposeintersection}, leaving a set $T$ of trim matrices that
    are not properly decomposable
  \item
    The minimal generating set of $\Refn$ is then $T \cup E$.
\end{enumerate}
Using this algorithm, we can calculate the sizes of minimal generating sets up
to $n = 7$; these are contained in Figure~\ref{fig:reflexiverank}.

\begin{figure}
  \centering
  \begin{tabular}{l|r|r}
    $n$ & $\mathbf{d}(\Refn)$ &   \\
    \hline
    1 & 1          & - \\ 
    2 & 2          & - \\ 
    3 & 8          & - \\ 
    4 & 38         & - \\
    5 & 1415       & \cmark \\
    6 & 482\ 430   & \cmark \\ 
    7 & 1\ 034\ 972\ 230          & \cmark \\
  \end{tabular}
  \caption{The minimum size $d(\Refn)$ of a generating set for the monoid
    consisting of all reflexive $n \times n$ Boolean matrices matrices where:
    ``-'' indicates a value that can be computed by hand or brute force;
    ``\cmark'' indicates that the value was first found here; ``?'' indicates
    that the value is unknown.}
  \label{fig:reflexiverank}
\end{figure}

There are a small number of matrices in $\Ref{7}$ for which an approach based on
\thref{lem:decomposeintersection} is too inefficient. These matrices can be
handled by attempting to write them as a product $A = BC$ of matrices $C$, which
are similar to representatives TODO finish this and make sure what I did was
correct.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Hall Matrices}
%The submonoid of $\Bn$ consisting of those boolean matrices containing a
%permutation matrix is particularly interesting. It is often called the
%\emph{Hall monoid} since matrices containing a permutation matrix correspond to
%instances of the Hall marriage problem that have a solution, and are thus
%referred to as \emph{Hall matrices}. We will denote the Hall monoid by
%$\Halln$. 
%
%In order to prove our main result on the Hall monoid, we will need the following
%classical result, restated in our context.
%
%\begin{thm}[Hall's Marriage Theorem]
%  Let $A in \Bn$. Then $A$ is a Hall matrix if and only if every union of $k$
%  rows contains at least $k$ ones, for $1 \leq k \leq n$.
%\end{thm}
%We shall say that a subset $X$ of the rows of a matrix \emph{satisfies the Hall
%  condition} if the union of the rows in $X$ contains at least $|X|$ ones, and
%that a matrix satifies the Hall condition if every subset of the rows satisfies
%the Hall condition.
%
%It will be useful in this section to define $e_i$ to be the boolean vector of
%length $n$ with a single $1$ in position $i$.
%
%The Hall monoid is similar in certain ways to $\Refn$. In particular
%the $\J$-relation is easily described through the following lemmas.
%
%\begin{lemma}
%  \thlabel{lem:HallContainment}
%  For any $A, B \in \Halln$, the product $AB$ contains at least as many ones as
%  $A$ or $B$ does.
%\end{lemma}
%\begin{proof}
%  Since $A \in \Halln$, $A$ contains a permutation matrix; hence $AB$ contains a
%  row-permuted copy of $B$. Similarly, $AB$ contains a column-permuted copy of
%  $A$.
%\end{proof}
%
%\begin{lemma}
%  \thlabel{lem:HallJRelation}
%  Two matrices $A, B \in \Halln$ are $\J$-related in $\Halln$ if and only if $A
%  = PBQ$ for two permutation matrices $P, Q \in S_n$.
%\end{lemma}
%\begin{proof}
%  The forward direction is clear. For the reverse, suppose that $A = SBT$ and $B
%  = UAV$ for matrices $S, T, U, V \in \Halln$. Then $BT$ contains a
%  column-permuted copy of $B$, and hence $A$ contains a row- and column-permuted
%  copy of $B$. Since, similarly, $B$ contains a row- and column-permuted copy of
%  $A$, it follows that $A$ is a row- and column-permutation of $B$.
%\end{proof}
%
%Unlike $\Refn$, $\Halln$ has a particularly nice minimal generating set.
%\begin{lemma}
%  Every minimal generating set for $\Halln$ is obtained by removing a rank $n-1$
%  matrix from a minimal generating set for $\Bn$. That is, every minimal
%  generating set for $\Halln$ consists of a set of representatives $P$ of the
%  prime $J$-classes of $\Bn$ together with two generators for the group of units
%  $S_n$ and an elementary matrix.
%\end{lemma}
%\begin{proof}
%  The fact that $P \subset \Halln$ is a consequence of the discussion after
%  \cite[Definition 2.4]{Caen1981aa}. Let $G \subset \Halln$ be obtained as in
%  the statement. To establish that $G$ is a generating set, we will show that
%  any Hall matrix that lies below the matrices in $G$ in the $\J$-order may be
%  written as a product of two higher non-permutation Hall matrices, and
%  therefore by an infinite ascent argument may be factorized into matrices in
%  $G$.
%  
%  Note that $G$ consists of matrices from the maximal $\J$-class and all
%  one-below-maximal $\J$-classes. By \thref{lem:PermutingReducedMatrices}, every
%  matrix in the $\J$-classes of matrices in $G$ is generated by $G$.
%
%  Let $A$ be a Hall matrix that lies below $G$ in the $\J$-order. We may assume
%  without loss of generality that $A$ contains the identity permutation, since
%  $\langle G \rangle$ contains $S_n$. We will decompose $A$ as a product of
%  non-permutation Hall matrices that lie above $A$ in the $\J$-order. 
%
%  First, suppose that $A$ is not trim, i.e.\ some row $i$ of $A$ is contained in
%  row $j$. Let $B$ be the matrix obtained by setting entry $i$ of row $j$ to be
%  equal to $0$, and $C$ be the greedy left multiplier of $B$ with respect to
%  $A$. Then $B$ and $C$ both contain the identity permutation, and hence are
%  Hall matrices. Since row $i$ of $B$ is contained in row $j$ of $A$, entry $(j,
%  i)$ of $C$ is $1$ and hence $C$ is not a permutation matrix.  Since $A$ was
%  not an elementary matrix, and $B$ was obtained by removing a single $1$ from
%  $A$, $B$ is not a permutation matrix. Finally, $A = CB$.
%
%  We now assume that $A$ is trim. Since $A$ lies below $G$ in the $\J$-order, it
%  has non-maximal row space. Let $B$ be a maximal non-permutation matrix in
%  $\Bn$ which contains the row space of $A$. Then $B$ is prime or elementary,
%  and hence is similar to some matrix in $G$. By multiplying by permutation
%  matrices $U$ and $V$, we may assume that $UBV$ contains the identity
%  permutation. Now $A = CB$ where $C$ is the greedy multiplier. Since $A$ is
%  trim, we must also have that $C$ is trim. However, there is no reason that $C$
%  must be a Hall matrix.
%  
%  Suppose that $C$ is a Hall matrix. Then, since $B$ is not similar to $A$, $C$
%  is not a permutation matrix.  Since $B$ is not a permutation matrix, $C$ is
%  not similar to $A$. By \thref{lem:HallJRelation}, $B$ and $C$ are both
%  non-permutation matrices which are greater than $A$ in the $\J$-order.
%
%  Now, if $C$ is not a Hall matrix, then it does not satisfy the Hall condition
%  and hence there is some minimal subset of rows $W \subseteq \{1, \ldots, n \}$
%  that do not satisfy the Hall condition. By multiplying by permutation matrices
%  $X$ and $Y$, and working with the matrix $XCY$, we may assume that $W = \{1,
%    \ldots, r \}$ and that the union of rows $1$ up to $r$ contains a $1$ in
%  positions $1$ up to $s$, $s < r$. We now construct two new matrices $S, T \in
%  \Halln$ such that $A = ST$. 
%  Let $x, y, u, v$ be the permutations of $\{1, \ldots, n \}$ associated with
%  the matrices $X, Y, U, V$. For $1 \leq i \leq s$, define row $i$ of $S$ to
%  be row $i$ of $XCY$ and row $i$ of $T$ to be row $i$ of $UBV$. For $s + 1 \leq
%  i \leq r$, define row $i$ of $S$ to be row $i$ of $XCY$ plus $e_i$, and define
%  row $i$ of $T$ to be $e_i$. For $r + 1 \leq i \leq n$, define row $i$ of $S$
%  to be $e_i$, and row $i$ of $T$ to be row $i$ of $A$. 
%  
%  
%  Oh dear, this doesn't work.
% 
%
%  We note now
%  that if $A$ is similar to a direct sum of a Hall matrix in $\Hall{m}$, $m <
%  n$, and an $(n-m)$ dimension identity matrix, then $A$ is decomposable into 
%
%\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Transformation Hall Matrices}
The previous section may be viewed in the context of ``matrices which are forced
to contain a certain permutation''. We now relax this requirement to consider
the monoid $\MTn$ of matrices which contain a transformation, i.e. have a $1$ in
every row.

\begin{lemma}
  All minimal generating sets for $\MTn$ are obtained by replacing the rank $n -
  1$ matrix in a minimal generating set for $\Bn$ by a matrix similar to
  \begin{align*}
    F' = \begin{pmatrix}
      0 & 1 & 0 & 0 & \cdots & 0 \\
      0 & 1 & 0 & 0 & \cdots & 0 \\
      0 & 0 & 1 & 0 & \cdots & 0 \\
      0 & 0 & 0 & 1 & \cdots & 0 \\
        &   &   \dots & \dots & \\
      0 & 0 & 0 & 0 & \cdots & 1
    \end{pmatrix}
  \end{align*}
\end{lemma}
\begin{proof}
  Since all prime matrices have full rank, such a set $G$ is contained in
  $\MTn$. To see that it is a generating set, consider a matrix $A$ which is not
  $\J$-related to any matrix in $G$. We wish to write $A$ as a product of
  matrices which lie strictly above $A$ in the $\J$-order. 
  
  Suppose that $A$ is not row-trim, and row $i$ is contained in row $j$. Then
  subtracting row $i$ from row $j$, we obtain a new matrix $A'$. If row $j$ is
  now empty, we then insert any row that is not in the row space of $A$ as row
  $j$. Now $A$ is the product $F''A'$ of $A'$ with some matrix similar to $F'$. By
  replacing $A$ with $A'$, and repeating if necessary, we may assume that $A$ is
  row-trim; a dual procedure allows us to assume that $A$ is column-trim. 
  
  Let $A_0 = A$. Then we write $A_0 = B_0C_0$ where $B_0, C_0 \in \Bn$, $B_0$ has a
  maximal row-space amongst non-permutation matrices, and $C_0$ is the greedy left
  multiplier. Since $B_0$ is Hall, it lies in $\MTn$; it is also $\J$-related to
  some matrix in $G$ and hence lies above $A_0$. Since $A_0$ is trim, $C_0$ must also
  be trim, and similarly since $A_0$ contains no zero row neither does $C_0$.
  However, $B_0$ is not a permutation matrix, and therefore $A_0 = C_0B_0$ contains more
  $1$s than $C_0$ does. Now either $C_0$ also lies strictly above $A_0$, in which case
  we are done, or we can repeat the process with $A_1 = C_0$. Since we
  cannot continue producing matrices with fewer and fewer ones forever,
  eventually we must decompose one of the $A_i$s as desired; then the product $A
  = C_i B_i B_{i - 1} \ldots B_1$ consists of matrices strictly above $A$ in the
  $\J$-order, which all lie in $\MTn$. Hence by Lemma~TODO, $G$ generates
  $\MTn$.
  Now, since every generating set for $\Bn$ must contain a representative of
  each prime $\J$-class and an elementary matrix, so too must every generating
  set for $\MTn$. Now $F'$ is not Hall, while all prime and elementary matrices
  are Hall, so $F'$ is not generated by prime and elementary matrices. Hence,
  any such generating set $G$ is minimal. TODO: clean up this last paragraph.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Triangular matrices}
We now turn our attention to the monoids of upper and lower triangular boolean
matrices, denoted by $\UTn$ and $\LTn$ respectively. These matrices have a
particularly simple minimal generating set:

\begin{lemma}
  \thlabel{lem:mingeneratingsetfortriangular}
  The unique minimal (monoid) generating set $X$ for $\UTn$ [$\LTn$] consists of
  those elementary matrices and matrices similar to $F$ which are upper [lower]
  triangular.
\end{lemma}

\begin{proof}
  We will prove the lemma for upper triangular matrices; the proof for lower
  triangular matrices is dual.
  We will first construct any matrix $A \in \UTn$ as a product of matrices in
  $X$. We iteratively define a product $A_i$, $0 \leq i \leq n$ where $A_0$ is
  the identity and $n$ is the number of $1$s in $A$. For the $i$-th $1$
  contained in $A$ (ordered by row then column) with position $(x_i, y_i)$, we
  obtain $A_i$ from $A_{i - 1}$ by left-multiplying by $E_{x_i, y_i}$. Let the
  zero rows of $A$ have indices $\{z_1, \ldots, z_{k}\}$. Note that the matrices
  in $\UTn$ similar to $F$ are precisely those matrices obtained by deleting a
  single $1$ from an identity matrix. We define $A_{n + j}$ to be matrix
  obtained by left multiplying $A_{n + j - 1}$ by the element of $X$ with a zero
  row in position $z_j$. Then $A_{n + k} = A$. (TODO: prove this construction
  actually works).
  
  
  Now it is easy to show that for each matrix $A \in X$, if $A$ is written as a
  product $A = BC$ in $\UTn$ then one of $B$ or $C$ must be equal to $A$; hence
  any generating set for $\UTn$ must contain all matrices in $X$. Hence $X$ is
  the unique minimal generating set for $\UTn$.
\end{proof}

\section{Tropical matrices}
Another class of semiring which has attracted significant recent attention (see
~\cite{TODO}) is the tropical min-plus semirings which are interesting because
TODO. The monoids of matrices over these semirings have significantly more
complex behaviour than the boolean matrix monoid (see \cite{TODO}).

\subsection{Min-plus matrices}

\begin{thm}[J, J, J]\label{thm-min-plus}
  The monoid $M_{2}(K^{\infty})$ of $2 \times 2$ min-plus matrices is
  generated by the matrices:
  \begin{equation*}
          A_{i} = \mat{i}{0}{0}{\infty},
    \quad B     = \mat{1}{\infty}{\infty}{0},
    \quad \text{and}
    \quad C     =  \mat{\infty}{\infty}{\infty}{0}
  \end{equation*}
  where $i \in \N \cup \{\infty\}$.
\end{thm}

\begin{cor}[J, J, J]\label{cor-finite-min-plus}
  Let $t \in \N$ be arbitrary. Then the finite monoid $M_{2}(K^{\infty}_t)$ of
  $2 \times 2$ min-plus matrices is generated by the $t + 4$ matrices:
  \begin{equation*}
          A_{i} = \mat{i}{0}{0}{\infty},
    \quad B     = \mat{1}{\infty}{\infty}{0},
    \quad \text{and}
    \quad C     =  \mat{\infty}{\infty}{\infty}{0}
  \end{equation*}
  where $i \in \{0, 1, \ldots, t, \infty\}$.
\end{cor}

\subsection{Max-plus matrices}
???? Seems like a natural thing to include.

\section{Matrices over $\mathbb{Z}_n$}

\begin{thm}[Wilf]
  The monoid $M_{k}(\mathbb{Z}_{n})$ is generated by $GL_{k}(\mathbb{Z}_{n})$ and
  any one element from each of the $\D$-classes immediately below the group of
  units. In particular, you could choose
  the diagonal matrices
  $$\begin{pmatrix}
    n/p    & 0      & \cdots & 0  \\
    0      & 1      &        & \vdots \\
    \vdots &        & \ddots & 0 \\
    0      & \cdots & 0      & 1  \\
   \end{pmatrix},$$
   for each prime divisor $p$ of $n$.
\end{thm}
Note that by the same logic as everywhere else this must be minimal.

\printbibliography
\end{document} 
